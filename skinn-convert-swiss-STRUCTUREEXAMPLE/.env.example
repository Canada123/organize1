# SKIIN Switzerland - Environment Configuration
# Security Implementation with P0 Fixes
# Version: 1.0 - 2025-08-22

#==============================================================================
# SUPABASE CONFIGURATION
#==============================================================================
VITE_SUPABASE_URL=https://your-project.supabase.co
VITE_SUPABASE_ANON_KEY=your_anon_key_here
SUPABASE_SERVICE_ROLE_KEY=your_service_role_key_here
SUPABASE_JWT_SECRET=your_jwt_secret_here

#==============================================================================
# API SECURITY SETTINGS
#==============================================================================
# Server Configuration
VITE_API_URL=http://localhost:8080/api
API_SERVER_PORT=8080
NODE_ENV=development

# Security Keys
JWT_SECRET=your_super_secure_jwt_secret_at_least_32_characters_long_here
SESSION_SECRET=your_super_secure_session_secret_at_least_32_characters_long_here
ENCRYPTION_KEY=your_encryption_key_32_chars_exactly_here

# CORS Configuration
CORS_ORIGIN=http://localhost:8080,https://skiin.ch,https://app.skiin.ch
CORS_CREDENTIALS=true

#==============================================================================
# OTP SECURITY CONFIGURATION
#==============================================================================
# Rate Limiting - OTP Generation
OTP_GENERATION_RATE_LIMIT=5
OTP_GENERATION_WINDOW_MINUTES=10
OTP_GENERATION_MAX_DAILY=20

# Rate Limiting - OTP Verification
OTP_VERIFICATION_RATE_LIMIT=10
OTP_VERIFICATION_WINDOW_MINUTES=10
OTP_VERIFICATION_MAX_ATTEMPTS=5

# OTP Settings
OTP_LENGTH=6
OTP_EXPIRY_MINUTES=10
OTP_BCRYPT_ROUNDS=12

# Blocking Configuration
OTP_IP_BLOCK_THRESHOLD=15
OTP_IP_BLOCK_DURATION_HOURS=24
OTP_USER_BLOCK_THRESHOLD=10
OTP_USER_BLOCK_DURATION_HOURS=4

#==============================================================================
# RATE LIMITING CONFIGURATION
#==============================================================================
# Global API Rate Limits
RATE_LIMIT_REQUESTS_PER_HOUR=1000
RATE_LIMIT_REQUESTS_PER_MINUTE=50
RATE_LIMIT_BURST_SIZE=20

# Endpoint-Specific Limits
ELIGIBILITY_RATE_LIMIT=10
PAYMENT_RATE_LIMIT=5
CONTACT_RATE_LIMIT=20

# Rate Limit Windows (minutes)
RATE_LIMIT_WINDOW=60
RATE_LIMIT_SHORT_WINDOW=1

#==============================================================================
# PAYMENT PROCESSING (PCI DSS)
#==============================================================================
# Stripe Configuration
STRIPE_PUBLIC_KEY=pk_test_your_stripe_public_key_here
STRIPE_SECRET_KEY=sk_test_your_stripe_secret_key_here
STRIPE_WEBHOOK_SECRET=whsec_your_webhook_secret_here

# Payment Security
PAYMENT_MAX_AMOUNT_CHF=1000
PAYMENT_MIN_AMOUNT_CHF=1
PAYMENT_FRAUD_THRESHOLD_SCORE=75
PAYMENT_REQUIRE_3DS=true

# Swiss Payment Methods
ENABLE_TWINT=true
ENABLE_POSTFINANCE=true
ENABLE_BANCONTACT=false
ENABLE_SOFORT=true

#==============================================================================
# SWISS HEALTHCARE COMPLIANCE
#==============================================================================
# Healthcare Settings
HEALTHCARE_COMPLIANCE_MODE=strict
GDPR_COMPLIANCE_REQUIRED=true
SWISS_DATA_RESIDENCY=true

# Insurance Providers
ENABLE_KPT=true
ENABLE_HELSANA=true
ENABLE_CSS=true
ENABLE_SWICA=true
ENABLE_SANITAS=true
ENABLE_CONCORDIA=true
ENABLE_VISANA=true
ENABLE_GROUPE_MUTUEL=true
ENABLE_ATUPRI=true

# Medical Classification
MAX_CONTRAINDICATIONS=5
REQUIRE_GP_APPROVAL=true
AUTO_REFERRAL_THRESHOLD=3

#==============================================================================
# CORS CONFIGURATION
#==============================================================================
# Allowed Origins (comma-separated)
CORS_ALLOWED_ORIGINS=http://localhost:8080,http://localhost:3000,https://skiin.ch,https://www.skiin.ch,https://app.skiin.ch

# CORS Headers
CORS_ALLOWED_METHODS=GET,POST,PUT,DELETE,OPTIONS
CORS_ALLOWED_HEADERS=Content-Type,Authorization,X-Requested-With,X-API-Key,X-Session-Token
CORS_EXPOSE_HEADERS=X-RateLimit-Remaining,X-RateLimit-Reset,X-Request-ID

# CORS Timing
CORS_MAX_AGE=86400
CORS_PRELIGHT_CONTINUE=false

#==============================================================================
# SECURITY HEADERS
#==============================================================================
# Content Security Policy
CSP_DEFAULT_SRC="'self' https://fonts.googleapis.com https://fonts.gstatic.com"
CSP_SCRIPT_SRC="'self' 'unsafe-inline' https://js.stripe.com https://cdn.jsdelivr.net"
CSP_STYLE_SRC="'self' 'unsafe-inline' https://fonts.googleapis.com"
CSP_IMG_SRC="'self' data: https:"
CSP_CONNECT_SRC="'self' https://api.stripe.com https://*.supabase.co"

# Security Headers
HSTS_MAX_AGE=31536000
FRAME_OPTIONS=DENY
CONTENT_TYPE_OPTIONS=nosniff
REFERRER_POLICY=strict-origin-when-cross-origin

#==============================================================================
# SESSION MANAGEMENT
#==============================================================================
# Session Configuration
SESSION_COOKIE_NAME=skiin_session
SESSION_COOKIE_SECURE=true
SESSION_COOKIE_HTTP_ONLY=true
SESSION_COOKIE_SAME_SITE=strict
SESSION_MAX_AGE_SECONDS=86400

# Session Security
SESSION_REGENERATE_ON_AUTH=true
SESSION_INVALIDATE_ON_LOGOUT=true
MAX_CONCURRENT_SESSIONS=3

#==============================================================================
# DATABASE CONFIGURATION
#==============================================================================
# Connection Settings
DB_POOL_MIN=2
DB_POOL_MAX=20
DB_CONNECTION_TIMEOUT=30000
DB_IDLE_TIMEOUT=30000
DB_STATEMENT_TIMEOUT=60000

# Security Settings
DB_SSL_MODE=require
DB_SSL_REJECT_UNAUTHORIZED=true
DB_ENABLE_AUDIT_LOG=true

#==============================================================================
# MONITORING & LOGGING
#==============================================================================
# Log Levels
LOG_LEVEL=info
SECURITY_LOG_LEVEL=warn
AUDIT_LOG_LEVEL=info

# Log Destinations
LOG_TO_CONSOLE=true
LOG_TO_FILE=true
LOG_TO_SUPABASE=true

# Security Monitoring
ENABLE_SECURITY_ALERTS=true
SECURITY_ALERT_THRESHOLD=5
FAILED_AUTH_ALERT_THRESHOLD=10

# Performance Monitoring
ENABLE_PERFORMANCE_MONITORING=true
SLOW_QUERY_THRESHOLD_MS=1000
API_RESPONSE_TIME_THRESHOLD_MS=200

#==============================================================================
# EMAIL CONFIGURATION (OTP Delivery)
#==============================================================================
# SMTP Settings for OTP delivery
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_SECURE=false
SMTP_USER=your_email@gmail.com
SMTP_PASS=your_app_password

# Email Templates
OTP_EMAIL_FROM="SKIIN Switzerland <noreply@skiin.ch>"
OTP_EMAIL_SUBJECT="Your SKIIN Verification Code"

#==============================================================================
# SMS CONFIGURATION (OTP Delivery)
#==============================================================================
# Twilio Configuration for SMS OTP
TWILIO_ACCOUNT_SID=your_twilio_account_sid
TWILIO_AUTH_TOKEN=your_twilio_auth_token
TWILIO_PHONE_NUMBER=+41xxxxxxxxx

# SMS Settings
SMS_PROVIDER=twilio
SMS_RATE_LIMIT=3
SMS_DAILY_LIMIT=10

#==============================================================================
# DEVELOPMENT/TESTING SETTINGS
#==============================================================================
# Development Flags
ENABLE_TEST_ENDPOINTS=false
ENABLE_MOCK_PAYMENTS=true
ENABLE_MOCK_SMS=true
ENABLE_DEBUG_LOGGING=false

# Testing Configuration
TEST_OTP_CODE=123456
TEST_PAYMENT_SUCCESS=true
BYPASS_RATE_LIMITS=false

# Performance Testing
ENABLE_LOAD_TESTING=false
MAX_CONCURRENT_REQUESTS=100

#==============================================================================
# PRODUCTION OVERRIDES
#==============================================================================
# Production Security (set these in production)
# JWT_SECRET=production_jwt_secret_64_characters_minimum_for_security_compliance
# SESSION_SECRET=production_session_secret_64_characters_minimum_for_security
# ENCRYPTION_KEY=production_encryption_key_exactly_32_chars
# STRIPE_SECRET_KEY=sk_live_your_production_stripe_key
# SUPABASE_SERVICE_ROLE_KEY=production_service_role_key

# Production URLs
# VITE_API_URL=https://api.skiin.ch
# VITE_SUPABASE_URL=https://your-production-project.supabase.co
# CORS_ALLOWED_ORIGINS=https://skiin.ch,https://www.skiin.ch,https://app.skiin.ch

# Production Flags
# NODE_ENV=production
# ENABLE_TEST_ENDPOINTS=false
# ENABLE_MOCK_PAYMENTS=false
# ENABLE_MOCK_SMS=false
# LOG_LEVEL=warn

# Development Notes:
# 1. Copy this file to .env.local
# 2. Fill in your actual Supabase values
# 3. The application will work with mock data if these are not set
# 4. Never commit real keys to version control
# 5. All security settings include P0 compliance configurations
# 6. Rate limiting and bcrypt are configured for production security